<DIV class="gs gr hl hm hn" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<H1 id=9697 class="pw-post-title ho hp hq bf hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="" data-testid="storyTitle">How I Made $16,500 Hacking CDN Caching Servers &#8212; Part 3 
<P><SPAN class=headers>Title:</SPAN></B><SPAN class=RefText> &#25105;&#22914;&#20309;&#36890;&#36807;&#40657;&#23458;&#25915;&#20987; CDN &#32531;&#23384;&#26381;&#21153;&#22120;&#36186;&#21462;16,500&#32654;&#20803; &#8212; &#31532;3&#37096;&#20998;</SPAN></FONT></H1></P></DIV>
<DIV data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<H2 id=e1e7 class="pw-subtitle-paragraph in hp hq bf b io ip iq ir is it iu iv iw ix iy iz ja jb jc ct ea" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph=""><SPAN class=headers><SPAN class=headers>Author:</SPAN></B><SPAN class=RefText> bxmbn</SPAN></FONT></SPAN><SPAN class=RefText></FONT></SPAN></FONT></H2>
<P class="pw-subtitle-paragraph in hp hq bf b io ip iq ir is it iu iv iw ix iy iz ja jb jc ct ea" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph="">&nbsp;&nbsp;&nbsp; <SPAN class=headers>Link:</SPAN></B><SPAN class=RefText> <A href="https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-3-91f9d836e046">https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-3-91f9d836e046</A></SPAN></P>
<P class="pw-subtitle-paragraph in hp hq bf b io ip iq ir is it iu iv iw ix iy iz ja jb jc ct ea" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph=""><SPAN class=RefText></SPAN></FONT>&nbsp;&nbsp;&nbsp; <SPAN class=headers>Source:</SPAN></B><SPAN class=RefText> infosec writeups</SPAN></FONT></FONT></P></DIV></DIV>
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">&nbsp;</DIV>
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1"><FIGURE class="nx ny nz oa ob oc nu nv paragraph-image" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="nu nv nw" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1"><PICTURE data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1"><img role=presentation class="bh es od c" alt="" src="https://miro.medium.com/v2/resize:fit:610/1*pyZEcnS5fLESc8yUS4wbdA.png" width=610 height=372 data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-cubox-image-load="false" data-cubox-image-index="4" data-cubox-image-id="70f3e5fa315f82ff4d4902eb8f7488a5" loading="eager"></PICTURE></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<H1 id=4fa8 class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Cache Poisoning DoS Via X-Forwarded-Scheme Header 
<P>&#36890;&#36807; X-Forwarded-Scheme &#22836;&#30340;&#32531;&#23384;&#20013;&#27602; DoS</H1>
<BLOCKQUOTE class="pf pg ph" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<P id=2476 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph=""><EM class=hq data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1">Bounty: 3,000&nbsp;&nbsp;&#36175;&#37329;&#65306;3,000</EM></P></BLOCKQUOTE>
<P id=4c25 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I didn&#8217;t know this was a thing, until i saw @iustinBB &#8217;s a blog about their research on Cache Poisoning<SPAN>&nbsp;</SPAN><A class="ag gq" href="https://youst.in/posts/cache-poisoning-at-scale/" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">Cache Poisoning at Scale</A> 
<P>&#25105;&#19981;&#30693;&#36947;&#36825;&#26159;&#19968;&#20010;&#20107;&#24773;&#65292;&#30452;&#21040;&#25105;&#30475;&#21040; @iustinBB &#30340;&#21338;&#23458;&#20851;&#20110;&#20182;&#20204;&#22312;&#22823;&#35268;&#27169;&#32531;&#23384;&#27745;&#26579;&#26041;&#38754;&#30340;&#30740;&#31350;</P><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=f82b class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">Sending the x-forwarded-scheme: http header would result  into a 301 redirect to the same location. If the response was cached by a CDN, it would cause a redirect loop, inherently denying access to the  file.</SPAN></PRE>
<P id=6af9 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I quickly remembered a Private Program&#8217;s asset that was using caching servers and using Ruby on Rails 
<P>&#25105;&#24456;&#24555;&#24819;&#36215;&#19968;&#20010;&#31169;&#20154;&#31243;&#24207;&#30340;&#36164;&#20135;&#65292;&#23427;&#20351;&#29992;&#20102;&#32531;&#23384;&#26381;&#21153;&#22120;&#24182;&#37319;&#29992; Ruby on Rails</P>
<H2 id=ba91 class="qh om hq bf on fg ql fh fi fj qm fk fl fm qn fn fo fp qo fq fr fs qp ft fu qq bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Request:&nbsp;&nbsp;&#35831;&#27714;&#65306;</H2><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=44f2 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">GET /?xxx HTTP/2 <P>Host: Redacted<P>X-Forwarded-Scheme: http <P>...</SPAN></P></PRE>
<P id=9b6e class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph=""><EM class=pk data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1">If you will test this, you should always use &#8220;cache busters&#8221; (?anything=x) in this case, i used (?xxx) so i don&#8217;t mistakenly poisoned other users. 
<P>&#22914;&#26524;&#20320;&#35201;&#36827;&#34892;&#27979;&#35797;&#65292;&#24212;&#35813;&#22987;&#32456;&#20351;&#29992;&#8220;cache busters&#8221;&#65288;?anything=x&#65289;&#65292;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#25105;&#20351;&#29992;&#20102;(?xxx)&#65292;&#20197;&#20813;&#38169;&#35823;&#22320;&#24433;&#21709;&#20854;&#20182;&#29992;&#25143;&#12290;</EM></P>
<H2 id=97ce class="qh om hq bf on fg ql fh fi fj qm fk fl fm qn fn fo fp qo fq fr fs qp ft fu qq bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Response:&nbsp;&nbsp;&#21709;&#24212;&#65306;</H2><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=9c62 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">HTTP/2 301 Moved Permanently <P>Date: Wed, 19 Jan 2022 17:16:13 GMT <P>Content-Type: text/html <P>Location: Redacted<P>Via: 1.1 vegur <P>Cf-Cache-Status: HIT <P>Age: 3</SPAN></P></PRE>
<P id=f10f class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">If an attacker timed the cache server and poison https://redacted/ 
<P>&#22914;&#26524;&#25915;&#20987;&#32773;&#23545;&#32531;&#23384;&#26381;&#21153;&#22120;&#36827;&#34892;&#20102;&#35745;&#26102;&#24182;&#20013;&#27602; https://redacted/</P>
<P id=b6fb class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The user&#8217;s response when requesting https://redacted/ will be 
<P>&#29992;&#25143;&#22312;&#35831;&#27714; https://redacted/ &#26102;&#30340;&#21709;&#24212;&#23558;&#26159;</P><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=f339 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">HTTP/2 301 Moved Permanently<P>Cf-Cache-Status: HIT </SPAN></P></PRE>
<P id=a079 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">They won&#8217;t be able to access<SPAN>&nbsp;</SPAN><A class="ag gq" href="https://redacted/" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">https://redacted/</A><SPAN>&nbsp;</SPAN>as the attacker saved the 301 redirect and would not load, until the cache refreshes. 
<P>&#20182;&#20204;&#26080;&#27861;&#35775;&#38382; https://redacted/&#65292;&#22240;&#20026;&#25915;&#20987;&#32773;&#20445;&#23384;&#20102; 301 &#37325;&#23450;&#21521;&#65292;&#24182;&#19988;&#22312;&#32531;&#23384;&#21047;&#26032;&#20043;&#21069;&#19981;&#20250;&#21152;&#36733;&#12290;</P></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<H1 id=9fef class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Timeline:&nbsp;&nbsp;&#26102;&#38388;&#32447;&#65306;</H1>
<BLOCKQUOTE class="pf pg ph" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<P id=2701 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Reported &#8594; January 19, 2022 
<P>&#25253;&#21578;&#26102;&#38388; &#8594; 2022 &#24180; 1 &#26376; 19 &#26085;</P>
<P id=7870 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Pending Program Review &#8594; January 25, 2022 
<P>&#24453;&#23457;&#31243;&#24207;&#35780;&#23457; &#8594; 2022 &#24180; 1 &#26376; 25 &#26085;</P>
<P id=da0a class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Triaged &#8594; January 25, 2022 
<P>&#20998;&#31867;&#22788;&#29702; &#8594; 2022 &#24180; 1 &#26376; 25 &#26085;</P>
<P id=a693 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Bounty Awarded &#8594; January 26, 2022 
<P>&#24748;&#36175;&#25480;&#20104; &#8594; 2022 &#24180; 1 &#26376; 26 &#26085;</P></BLOCKQUOTE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="ab ce" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">
<P id=7ad1 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The total $ for these 3 Reports was $11,300 
<P>&#36825;&#19977;&#20221;&#25253;&#21578;&#30340;&#24635;&#37329;&#39069;&#26159; 11,300 &#32654;&#20803;</P>
<P id=4342 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I chose only these 3 reports because they were the most awarded ones. 
<P>&#25105;&#21482;&#36873;&#25321;&#20102;&#36825; 3 &#20010;&#25253;&#21578;&#65292;&#22240;&#20026;&#23427;&#20204;&#26159;&#33719;&#22870;&#26368;&#22810;&#30340;&#12290;</P>
<P id=1bdd class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I applied the same methodology on other programs, this includes Cache Deception issues like<SPAN>&nbsp;</SPAN><A class="ag gq" href="https://hackerone.com/reports/1343086" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">#1343086</A> 
<P>&#25105;&#23545;&#20854;&#20182;&#31243;&#24207;&#24212;&#29992;&#20102;&#30456;&#21516;&#30340;&#26041;&#27861;&#35770;&#65292;&#21253;&#25324;&#32531;&#23384;&#27450;&#39575;&#38382;&#39064;&#65292;&#22914; #1343086</P>
<P id=956f class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Making a total of $15,400 on<SPAN>&nbsp;</SPAN><A class="ag gq" href="https://hackerone.com/" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">HackerOne</A><SPAN>&nbsp;</SPAN>and $1,100 on<SPAN>&nbsp;</SPAN><A class="ag gq" href="https://www.bugcrowd.com/" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">BugCrowd</A> 
<P>&#22312; HackerOne &#19978;&#36186;&#21462;&#24635;&#35745;$15,400&#65292;&#22312; BugCrowd &#19978;&#36186;&#21462;$1,100</P>
<P id=777a class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Thanks for Reading!&nbsp;&nbsp;&#35874;&#35874;&#38405;&#35835;&#65281;</P>
<P id=acf6 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Make sure to follow me on Twitter ;) 
<P>&#30830;&#20445;&#22312; Twitter &#19978;&#20851;&#27880;&#25105; ;)</P>
<P id=00ee class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1" data-selectable-paragraph=""><A class="ag gq" href="https://twitter.com/bxmbn" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="aad7041d-6203-4836-92e7-ec1d2908f7c1">@bxmbn</A>